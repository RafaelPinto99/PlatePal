<div class="survey-container" data-controller="questionshow">
  <div class="progress-bar">
    <div class="progress" data-questionshow-target="progress" style="width: 0%;"></div>
  </div>

  <form action="<%= step_submit_path(step: @step) %>" method="post">
    <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
    <%= hidden_field_tag :survey_step, @step %>


    <!-- Question 1 -->
    <% if @step == 0 %>
      <div data-questionshow-target="question">
        <h2 class="question-title">Question 1</h2>
        <p class="question-text">What is your primary goal for meal prep?</p>
        <div class="options">
          <% answers = [
            "Save time during the week.",
            "Create healthy, balanced meals.",
            "Stick to a specific diet (e.g., keto, vegetarian).",
            "Ensure meals are kid-friendly.",
            "Minimize food waste."
          ] %>

          <% emoji_map = {
            "Save time during the week." => "⏳",
            "Create healthy, balanced meals." => "💪",
            "Stick to a specific diet (e.g., keto, vegetarian)." => "🥗",
            "Ensure meals are kid-friendly." => "👦",
            "Minimize food waste." => "🌍"
          } %>

          <% answers.each do |answer| %>
            <label class="option">
              <input type="radio" name="survey[goals]" value="<%= answer.downcase.gsub(" ", "_") %>">
              <span class="emoji"><%= emoji_map[answer] %></span>
              <span class="label-text"><%= answer %></span>
            </label>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Question 2 -->
    <% if @step == 1 %>
      <div data-questionshow-target="question">
        <h2 class="question-title">Question 2</h2>
        <p class="question-text">How is your time availability?</p>
        <div class="options">
          <% answers = [
            "Limited time - I need quick, under 30-minute recipes.",
            "Open schedule - I can dedicate more time to cooking."
          ] %>

          <% answers.each do |answer| %>
            <label class="option">
              <input type="radio" name="survey[preferences]" value="<%= answer.downcase.gsub(" ", "_") %>">
              <span class="label-text"><%= answer %></span>
            </label>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Navigation buttons -->
    <div class="navigation">
      <% if @step > 0 %>
        <button type="submit" name="direction" value="previous" class="btn btn-secondary">Previous</button>
      <% end %>
      <button type="submit" name="direction" value="next" class="btn btn-primary">
        <%= @step < 3 ? "Next" : "Submit" %>
      </button>
    </div>
  </form>
</div>
